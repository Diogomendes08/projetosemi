from app import app, get_db_connection

@app.route('/empresa')
def listar_empresas():
    conn = get_db_connection()
    empresas = conn.execute('SELECT * FROM smartEsteque_empresa').fetchall()
    conn.close()
    return render_template('empresa/listar.html', empresas=empresas)

@app.route('/empresa/adicionar', methods=('GET', 'POST'))
def adicionar_empresa():
    if request.method == 'POST':
        endereco = request.form['endereco']
        telefone = request.form['telefone']
        email = request.form['email']
        cadastro = request.form['cadastro']
        id_sistema = request.form['id_sistema']
        
        conn = get_db_connection()
        conn.execute('INSERT INTO smartEsteque_empresa (endereco, telefone, email, cadastro, id_sistema) VALUES (?, ?, ?, ?, ?)',
                     (endereco, telefone, email, cadastro, id_sistema))
        conn.commit()
        conn.close()
        return redirect(url_for('listar_empresas'))
    
    return render_template('empresa/adicionar.html')
