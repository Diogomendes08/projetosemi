from app import app, get_db_connection

@app.route('/fornecedor')
def listar_fornecedores():
    conn = get_db_connection()
    fornecedores = conn.execute('SELECT * FROM fornecedor').fetchall()
    conn.close()
    return render_template('fornecedor/listar.html', fornecedores=fornecedores)

@app.route('/fornecedor/adicionar', methods=('GET', 'POST'))
def adicionar_fornecedor():
    if request.method == 'POST':
        id_empresa = request.form['id_empresa']
        telefone = request.form['telefone']
        email = request.form['email']
        crpj = request.form['crpj']
        
        conn = get_db_connection()
        conn.execute('INSERT INTO fornecedor (id_empresa, telefone, email, crpj) VALUES (?, ?, ?, ?)',
                     (id_empresa, telefone, email, crpj))
        conn.commit()
        conn.close()
        return redirect(url_for('listar_fornecedores'))
    
    return render_template('fornecedor/adicionar.html')
