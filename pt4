from app import app, get_db_connection

@app.route('/funcionario')
def listar_funcionarios():
    conn = get_db_connection()
    funcionarios = conn.execute('SELECT * FROM funcionarios').fetchall()
    conn.close()
    return render_template('funcionario/listar.html', funcionarios=funcionarios)

@app.route('/funcionario/adicionar', methods=('GET', 'POST'))
def adicionar_funcionario():
    if request.method == 'POST':
        cpf = request.form['cpf']
        email = request.form['email']
        nome = request.form['nome']
        id_cargo = request.form['id_cargo']
        id_sistema = request.form['id_sistema']
        
        conn = get_db_connection()
        conn.execute('INSERT INTO funcionarios (cpf, email, nome, id_cargo, id_sistema) VALUES (?, ?, ?, ?, ?)',
                     (cpf, email, nome, id_cargo, id_sistema))
        conn.commit()
        conn.close()
        return redirect(url_for('listar_funcionarios'))
    
    return render_template('funcionario/adicionar.html')
